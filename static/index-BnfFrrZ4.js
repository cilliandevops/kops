import{i as _,_ as M}from"./index-D604ZND0.js";import{b as v,B as R}from"./element-CaKE2_v0.js";import{m as w,r as c,f as E,c as U,ai as s,p as k,q as B,U as a,O as o,F as $,a8 as O,S as i,T as S}from"./vue-whfKlJIt.js";import"./vxe-HN9Qqgrb.js";const T=w({name:"PersistentVolume",setup(){const e=c([]),l=c(1),P=c(10),p=c(!1),m=c("新增PV"),r=c({metadata:{name:""},spec:{capacity:{storage:"1Gi"},accessModes:["ReadWriteOnce"]}}),d=E(()=>{const t=(l.value-1)*P.value,f=t+P.value;return e.value.slice(t,f)}),g=async()=>{try{const t=await _({url:"/apis/v1/k8s/persistentvolumes/default",method:"get",baseURL:"http://localhost:8080"});e.value=t}catch(t){console.error("获取PV数据失败:",t)}},u=t=>{l.value=t},b=()=>{m.value="新增PV",r.value={metadata:{name:""},spec:{capacity:{storage:"1Gi"},accessModes:["ReadWriteOnce"]}},p.value=!0},C=t=>{m.value="编辑PV",r.value=JSON.parse(JSON.stringify(t)),p.value=!0},y=async()=>{try{m.value==="新增PV"?(await _({url:"/apis/v1/k8s/persistentvolumes",method:"post",data:r.value,baseURL:"http://localhost:8080"}),v.success("PV新增成功")):(await _({url:`/apis/v1/k8s/persistentvolumes/${r.value.metadata.name}`,method:"put",data:r.value,baseURL:"http://localhost:8080"}),v.success("PV编辑成功")),p.value=!1,g()}catch(t){console.error("保存PV失败:",t),v.error("保存PV失败")}},V=t=>{R.confirm(`确定删除PV ${t.metadata.name} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await _({url:`/apis/v1/k8s/persistentvolumes/${t.metadata.name}`,method:"delete",baseURL:"http://localhost:8080"}),v.success("PV删除成功"),g()}catch(f){console.error("删除PV失败:",f),v.error("删除PV失败")}})};return U(()=>{g()}),{pvData:e,currentPage:l,pageSize:P,currentPageData:d,handlePageChange:u,dialogVisible:p,dialogTitle:m,currentPV:r,handleAdd:b,handleEdit:C,handleSave:y,handleDelete:V}}});function W(e,l,P,p,m,r){const d=s("el-table-column"),g=s("el-tag"),u=s("el-button"),b=s("el-table"),C=s("el-pagination"),y=s("el-input"),V=s("el-form-item"),t=s("el-option"),f=s("el-select"),F=s("el-form"),D=s("el-dialog");return k(),B("div",null,[a(b,{data:e.currentPageData,border:"",stripe:"",style:{width:"100%"}},{default:o(()=>[a(d,{prop:"metadata.name",label:"PV名称",width:"180"}),a(d,{prop:"spec.capacity.storage",label:"容量",width:"180"}),a(d,{prop:"spec.accessModes",label:"访问模式",width:"300"},{default:o(({row:n})=>[(k(!0),B($,null,O(n.spec.accessModes,h=>(k(),B("div",{key:h,class:"access-mode-tag"},[a(g,null,{default:o(()=>[i(S(h),1)]),_:2},1024)]))),128))]),_:1}),a(d,{label:"操作",width:"200"},{default:o(({row:n})=>[a(u,{type:"primary",onClick:h=>e.handleEdit(n)},{default:o(()=>[i("编辑")]),_:2},1032,["onClick"]),a(u,{type:"danger",onClick:h=>e.handleDelete(n)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(C,{currentPage:e.currentPage,"onUpdate:currentPage":l[0]||(l[0]=n=>e.currentPage=n),"page-size":e.pageSize,total:e.pvData.length,layout:"total, prev, pager, next, jumper",onCurrentChange:e.handlePageChange},null,8,["currentPage","page-size","total","onCurrentChange"]),a(D,{title:e.dialogTitle,modelValue:e.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=n=>e.dialogVisible=n)},{footer:o(()=>[a(u,{onClick:l[4]||(l[4]=n=>e.dialogVisible=!1)},{default:o(()=>[i("取消")]),_:1}),a(u,{type:"primary",onClick:e.handleSave},{default:o(()=>[i("保存")]),_:1},8,["onClick"])]),default:o(()=>[a(F,{model:e.currentPV,"label-width":"120px"},{default:o(()=>[a(V,{label:"PV名称"},{default:o(()=>[a(y,{modelValue:e.currentPV.metadata.name,"onUpdate:modelValue":l[1]||(l[1]=n=>e.currentPV.metadata.name=n)},null,8,["modelValue"])]),_:1}),a(V,{label:"容量"},{default:o(()=>[a(y,{modelValue:e.currentPV.spec.capacity.storage,"onUpdate:modelValue":l[2]||(l[2]=n=>e.currentPV.spec.capacity.storage=n)},null,8,["modelValue"])]),_:1}),a(V,{label:"访问模式"},{default:o(()=>[a(f,{modelValue:e.currentPV.spec.accessModes,"onUpdate:modelValue":l[3]||(l[3]=n=>e.currentPV.spec.accessModes=n),multiple:""},{default:o(()=>[a(t,{label:"ReadWriteOnce",value:"ReadWriteOnce"}),a(t,{label:"ReadOnlyMany",value:"ReadOnlyMany"}),a(t,{label:"ReadWriteMany",value:"ReadWriteMany"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),a(u,{type:"success",onClick:e.handleAdd},{default:o(()=>[i("新增PV")]),_:1},8,["onClick"])])}const q=M(T,[["render",W],["__scopeId","data-v-28e9176c"]]);export{q as default};
