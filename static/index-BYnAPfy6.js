import{i as _,_ as P}from"./index-D604ZND0.js";import{b as v,B as $}from"./element-CaKE2_v0.js";import{m as F,r as i,f as U,c as w,ai as s,p as V,q as y,U as l,O as r,S,F as B,a8 as A}from"./vue-whfKlJIt.js";import"./vxe-HN9Qqgrb.js";const E=F({name:"Secret",setup(){const e=i([]),n=i(1),h=i(10),m=i(!1),u=i("新增Secret"),c=i({metadata:{name:"",namespace:"default"},data:{}}),p=U(()=>{const a=(n.value-1)*h.value,t=a+h.value;return e.value.slice(a,t)}),o=async()=>{try{const a=await _({url:"/apis/v1/k8s/secrets",method:"get",baseURL:"http://localhost:8080"});e.value=a||[]}catch(a){console.error("获取Secret数据失败:",a),v.error("获取Secret数据失败")}},b=a=>{n.value=a},C=()=>{u.value="新增Secret",c.value={metadata:{name:"",namespace:"default"},data:{}},m.value=!0},f=a=>{u.value="编辑Secret",c.value=JSON.parse(JSON.stringify(a)),m.value=!0},g=async()=>{try{const a=u.value==="新增Secret"?"post":"put",t=u.value==="新增Secret"?"/apis/v1/k8s/secrets":`/apis/v1/k8s/secrets/${c.value.metadata.name}`;await _({url:t,method:a,data:c.value,baseURL:"http://localhost:8080"}),v.success(`${u.value}成功`),m.value=!1,o()}catch(a){console.error("保存Secret失败:",a),v.error("保存Secret失败")}},D=a=>{$.confirm(`确定删除Secret ${a.metadata.name} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await _({url:`/apis/v1/k8s/secrets/${a.metadata.name}`,method:"delete",baseURL:"http://localhost:8080"}),v.success("Secret删除成功"),o()}catch(t){console.error("删除Secret失败:",t),v.error("删除Secret失败")}})};return w(()=>{o()}),{secretData:e,currentPage:n,pageSize:h,currentPageData:p,handlePageChange:b,dialogVisible:m,dialogTitle:u,currentSecret:c,handleAdd:C,handleEdit:f,handleSave:g,handleDelete:D}}});function T(e,n,h,m,u,c){const p=s("el-table-column"),o=s("el-button"),b=s("el-table"),C=s("el-pagination"),f=s("el-input"),g=s("el-form-item"),D=s("el-form"),a=s("el-dialog");return V(),y("div",null,[l(b,{data:e.currentPageData,border:"",stripe:"",style:{width:"100%"}},{default:r(()=>[l(p,{prop:"metadata.name",label:"Secret名称",width:"180"}),l(p,{prop:"metadata.namespace",label:"命名空间",width:"180"}),l(p,{label:"操作",width:"200"},{default:r(({row:t})=>[l(o,{type:"primary",onClick:d=>e.handleEdit(t)},{default:r(()=>[S("编辑")]),_:2},1032,["onClick"]),l(o,{type:"danger",onClick:d=>e.handleDelete(t)},{default:r(()=>[S("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(C,{currentPage:e.currentPage,"onUpdate:currentPage":n[0]||(n[0]=t=>e.currentPage=t),"page-size":e.pageSize,total:e.secretData.length,layout:"total, prev, pager, next, jumper",onCurrentChange:e.handlePageChange},null,8,["currentPage","page-size","total","onCurrentChange"]),l(a,{title:e.dialogTitle,visible:e.dialogVisible,"onUpdate:visible":n[4]||(n[4]=t=>e.dialogVisible=t)},{footer:r(()=>[l(o,{onClick:n[3]||(n[3]=t=>e.dialogVisible=!1)},{default:r(()=>[S("取消")]),_:1}),l(o,{type:"primary",onClick:e.handleSave},{default:r(()=>[S("保存")]),_:1},8,["onClick"])]),default:r(()=>[l(D,{model:e.currentSecret,"label-width":"120px"},{default:r(()=>[l(g,{label:"Secret名称"},{default:r(()=>[l(f,{modelValue:e.currentSecret.metadata.name,"onUpdate:modelValue":n[1]||(n[1]=t=>e.currentSecret.metadata.name=t)},null,8,["modelValue"])]),_:1}),l(g,{label:"命名空间"},{default:r(()=>[l(f,{modelValue:e.currentSecret.metadata.namespace,"onUpdate:modelValue":n[2]||(n[2]=t=>e.currentSecret.metadata.namespace=t)},null,8,["modelValue"])]),_:1}),l(g,{label:"数据"},{default:r(()=>[(V(!0),y(B,null,A(e.currentSecret.data,(t,d)=>(V(),y("div",{key:d},[l(f,{modelValue:e.currentSecret.data[d],"onUpdate:modelValue":k=>e.currentSecret.data[d]=k,placeholder:String(d)},null,8,["modelValue","onUpdate:modelValue","placeholder"])]))),128))]),_:1})]),_:1},8,["model"])]),_:1},8,["title","visible"]),l(o,{type:"success",onClick:e.handleAdd},{default:r(()=>[S("新增Secret")]),_:1},8,["onClick"])])}const O=P(E,[["render",T],["__scopeId","data-v-993faf0b"]]);export{O as default};
