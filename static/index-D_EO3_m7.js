import{i as w,_ as E}from"./index-D604ZND0.js";import{b as B}from"./element-CaKE2_v0.js";import{m as N,r as d,f as P,c as $,ai as u,p as k,q as A,U as l,O as o,S as p,F as z,a8 as I,T as U,t as S}from"./vue-whfKlJIt.js";import"./vxe-HN9Qqgrb.js";const T=N({name:"Namespace",setup(){const e=d([]),t=d(1),v=d(10),D=d(""),c=d(!1),r=d({name:"",labels:{"kubernetes.io/metadata.name":""},status:"Active"}),s=d(""),i=async()=>{try{const n=await w({url:"/apis/v1/k8s/namespace",method:"get",baseURL:"http://localhost:8080"});e.value=n}catch(n){console.error("获取命名空间数据失败:",n)}},m=n=>{t.value=n},_=()=>{t.value=1},g=P(()=>e.value.filter(n=>n.name.includes(D.value))),h=P(()=>{const n=(t.value-1)*v.value,a=n+v.value;return g.value.slice(n,a)}),f=()=>{r.value={name:"",labels:{"kubernetes.io/metadata.name":""},status:"Active"},s.value="新增命名空间",c.value=!0},b=n=>{r.value={...n},s.value="编辑命名空间",c.value=!0},V=async()=>{if(s.value==="新增命名空间")e.value.push({...r.value});else{const n=e.value.findIndex(a=>a.name===r.value.name);n!==-1&&(e.value[n]={...r.value})}c.value=!1,B.success("操作成功")},C=n=>{e.value=e.value.filter(a=>a.name!==n),B.success("删除成功")};return $(()=>{i()}),{namespaceData:e,currentPage:t,pageSize:v,searchQuery:D,handleSearch:_,filteredData:g,paginatedData:h,handlePageChange:m,isDialogVisible:c,form:r,formTitle:s,handleAdd:f,handleEdit:b,saveNamespace:V,handleDelete:C}}}),Q={class:"dialog-footer"};function q(e,t,v,D,c,r){const s=u("el-input"),i=u("el-button"),m=u("el-table-column"),_=u("el-tag"),g=u("el-table"),h=u("el-pagination"),f=u("el-form-item"),b=u("el-option"),V=u("el-select"),C=u("el-form"),n=u("el-dialog");return k(),A("div",null,[l(s,{modelValue:e.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=a=>e.searchQuery=a),placeholder:"搜索命名空间",onInput:e.handleSearch,style:{width:"300px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),l(i,{type:"primary",onClick:e.handleAdd},{default:o(()=>[p("新增命名空间")]),_:1},8,["onClick"]),l(g,{data:e.paginatedData,border:"",stripe:"",style:{width:"100%","margin-top":"20px"}},{default:o(()=>[l(m,{prop:"name",label:"命名空间名称",width:"180"}),l(m,{label:"标签",width:"300"},{default:o(({row:a})=>[(k(!0),A(z,null,I(a.labels,(y,F)=>(k(),A("div",{key:F,class:"label-tag"},[l(_,null,{default:o(()=>[p(U(F)+": "+U(y),1)]),_:2},1024)]))),128))]),_:1}),l(m,{prop:"status",label:"状态",width:"180"}),l(m,{label:"操作",width:"180"},{default:o(({row:a})=>[l(i,{type:"primary",size:"small",onClick:y=>e.handleEdit(a)},{default:o(()=>[p("编辑")]),_:2},1032,["onClick"]),l(i,{type:"danger",size:"small",onClick:y=>e.handleDelete(a.name)},{default:o(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(h,{currentPage:e.currentPage,"onUpdate:currentPage":t[1]||(t[1]=a=>e.currentPage=a),"page-size":e.pageSize,total:e.filteredData.length,layout:"total, prev, pager, next, jumper",onCurrentChange:e.handlePageChange},null,8,["currentPage","page-size","total","onCurrentChange"]),l(n,{title:e.formTitle,modelValue:e.isDialogVisible,"onUpdate:modelValue":t[6]||(t[6]=a=>e.isDialogVisible=a)},{footer:o(()=>[S("div",Q,[l(i,{onClick:t[5]||(t[5]=a=>e.isDialogVisible=!1)},{default:o(()=>[p("取消")]),_:1}),l(i,{type:"primary",onClick:e.saveNamespace},{default:o(()=>[p("保存")]),_:1},8,["onClick"])])]),default:o(()=>[l(C,{model:e.form},{default:o(()=>[l(f,{label:"命名空间名称"},{default:o(()=>[l(s,{modelValue:e.form.name,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.name=a)},null,8,["modelValue"])]),_:1}),l(f,{label:"标签"},{default:o(()=>[l(s,{modelValue:e.form.labels["kubernetes.io/metadata.name"],"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.labels["kubernetes.io/metadata.name"]=a)},null,8,["modelValue"])]),_:1}),l(f,{label:"状态"},{default:o(()=>[l(V,{modelValue:e.form.status,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.status=a)},{default:o(()=>[l(b,{label:"Active",value:"Active"}),l(b,{label:"Inactive",value:"Inactive"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}const R=E(T,[["render",q],["__scopeId","data-v-b160e409"]]);export{R as default};
