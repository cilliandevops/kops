import{i as V,_ as U}from"./index-D604ZND0.js";import{m as $,r as g,f as w,c as A,ai as o,p as f,q as v,U as t,O as l,F as k,a8 as F,S as _,T as z,t as B}from"./vue-whfKlJIt.js";import"./element-CaKE2_v0.js";import"./vxe-HN9Qqgrb.js";const L=$({name:"Ingress",setup(){const e=g([]),s=g(1),b=g(10),c=g(!1),r=g({name:"",namespace:"",spec:{rules:[]}}),y=w(()=>{const a=(s.value-1)*b.value,i=a+b.value;return e.value.slice(a,i)}),u=async()=>{try{const a=await V({url:"/apis/v1/k8s/ingresses/default",method:"get",baseURL:"http://localhost:8080"});e.value=a||[]}catch(a){console.error("获取 Ingress 数据失败:",a)}},h=async()=>{try{const a=r.value.name?"put":"post",i=r.value.name?`/apis/v1/k8s/ingresses/${r.value.name}`:"/apis/v1/k8s/ingresses";await V({url:i,method:a,data:r.value,baseURL:"http://localhost:8080"}),u(),c.value=!1}catch(a){console.error("保存 Ingress 失败:",a)}},d=async a=>{try{await V({url:`/apis/v1/k8s/ingresses/${a}`,method:"delete",baseURL:"http://localhost:8080"}),u()}catch(i){console.error("删除 Ingress 失败:",i)}},C=a=>{s.value=a},I=a=>{r.value={...a},c.value=!0},m=()=>{r.value={name:"",namespace:"",spec:{rules:[]}},c.value=!0};return A(()=>{u()}),{ingressData:e,currentPage:s,pageSize:b,currentPageData:y,dialogVisible:c,currentIngress:r,handlePageChange:C,saveIngress:h,deleteIngress:d,editIngress:I,openDialog:m}}}),S={class:"dialog-footer"};function N(e,s,b,c,r,y){const u=o("el-table-column"),h=o("el-tag"),d=o("el-button"),C=o("el-table"),I=o("el-pagination"),m=o("el-input"),a=o("el-form-item"),i=o("el-form"),P=o("el-dialog");return f(),v("div",null,[t(C,{data:e.currentPageData,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(u,{prop:"name",label:"名称",width:"180"}),t(u,{prop:"namespace",label:"命名空间",width:"180"}),t(u,{prop:"spec.rules",label:"规则",width:"300"},{default:l(({row:n})=>[(f(!0),v(k,null,F(n.spec.rules,(p,D)=>(f(),v("div",{key:D,class:"rule-tag"},[t(h,null,{default:l(()=>[_(z(p.host),1)]),_:2},1024)]))),128))]),_:1}),t(u,{label:"动作",width:"200"},{default:l(({row:n})=>[t(d,{type:"primary",onClick:p=>e.editIngress(n)},{default:l(()=>[_("编辑")]),_:2},1032,["onClick"]),t(d,{type:"danger",onClick:p=>e.deleteIngress(n.name)},{default:l(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(I,{currentPage:e.currentPage,"onUpdate:currentPage":s[0]||(s[0]=n=>e.currentPage=n),"page-size":e.pageSize,total:e.ingressData.length,layout:"total, prev, pager, next, jumper",onCurrentChange:e.handlePageChange},null,8,["currentPage","page-size","total","onCurrentChange"]),t(P,{visible:e.dialogVisible,"onUpdate:visible":s[4]||(s[4]=n=>e.dialogVisible=n),title:"Ingress"},{footer:l(()=>[B("div",S,[t(d,{onClick:s[3]||(s[3]=n=>e.dialogVisible=!1)},{default:l(()=>[_("取消")]),_:1}),t(d,{type:"primary",onClick:e.saveIngress},{default:l(()=>[_("保存")]),_:1},8,["onClick"])])]),default:l(()=>[t(i,{model:e.currentIngress},{default:l(()=>[t(a,{label:"名称"},{default:l(()=>[t(m,{modelValue:e.currentIngress.name,"onUpdate:modelValue":s[1]||(s[1]=n=>e.currentIngress.name=n)},null,8,["modelValue"])]),_:1}),t(a,{label:"命名空间"},{default:l(()=>[t(m,{modelValue:e.currentIngress.namespace,"onUpdate:modelValue":s[2]||(s[2]=n=>e.currentIngress.namespace=n)},null,8,["modelValue"])]),_:1}),t(a,{label:"规则"},{default:l(()=>[(f(!0),v(k,null,F(e.currentIngress.spec.rules,(n,p)=>(f(),v("div",{key:p},[t(m,{modelValue:n.host,"onUpdate:modelValue":D=>n.host=D,placeholder:"规则 "+(p+1)},null,8,["modelValue","onUpdate:modelValue","placeholder"])]))),128))]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])}const E=U(L,[["render",N],["__scopeId","data-v-d7209e3f"]]);export{E as default};
