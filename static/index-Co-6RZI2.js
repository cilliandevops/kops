import{i as h,_ as M}from"./index-D604ZND0.js";import{b as v,B as w}from"./element-CaKE2_v0.js";import{m as R,r as i,f as U,c as E,ai as s,p as F,q as D,U as a,O as n,F as $,a8 as A,S as p,T as O}from"./vue-whfKlJIt.js";import"./vxe-HN9Qqgrb.js";const S=R({name:"PersistentVolumeClaim",setup(){const e=i([]),l=i(1),P=i(10),m=i(!1),C=i("新增PVC"),u=i({metadata:{name:"",namespace:"default"},spec:{resources:{requests:{storage:"1Gi"}},accessModes:["ReadWriteOnce"]}}),r=U(()=>{const t=(l.value-1)*P.value,f=t+P.value;return e.value.slice(t,f)}),V=async()=>{try{const t=await h({url:"/apis/v1/k8s/persistentvolumeclaims/default",method:"get",baseURL:"http://localhost:8080"});e.value=t}catch(t){console.error("获取PVC数据失败:",t)}},d=t=>{l.value=t},_=()=>{C.value="新增PVC",u.value={metadata:{name:"",namespace:"default"},spec:{resources:{requests:{storage:"1Gi"}},accessModes:["ReadWriteOnce"]}},m.value=!0},y=t=>{C.value="编辑PVC",u.value=JSON.parse(JSON.stringify(t)),m.value=!0},g=async()=>{try{C.value==="新增PVC"?(await h({url:"/apis/v1/k8s/persistentvolumeclaims",method:"post",data:u.value,baseURL:"http://localhost:8080"}),v.success("PVC新增成功")):(await h({url:`/apis/v1/k8s/persistentvolumeclaims/${u.value.metadata.name}`,method:"put",data:u.value,baseURL:"http://localhost:8080"}),v.success("PVC编辑成功")),m.value=!1,V()}catch(t){console.error("保存PVC失败:",t),v.error("保存PVC失败")}},c=t=>{w.confirm(`确定删除PVC ${t.metadata.name} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await h({url:`/apis/v1/k8s/persistentvolumeclaims/${t.metadata.name}`,method:"delete",baseURL:"http://localhost:8080"}),v.success("PVC删除成功"),V()}catch(f){console.error("删除PVC失败:",f),v.error("删除PVC失败")}})};return E(()=>{V()}),{pvcData:e,currentPage:l,pageSize:P,currentPageData:r,handlePageChange:d,dialogVisible:m,dialogTitle:C,currentPVC:u,handleAdd:_,handleEdit:y,handleSave:g,handleDelete:c}}});function q(e,l,P,m,C,u){const r=s("el-table-column"),V=s("el-tag"),d=s("el-button"),_=s("el-table"),y=s("el-pagination"),g=s("el-input"),c=s("el-form-item"),t=s("el-option"),f=s("el-select"),B=s("el-form"),k=s("el-dialog");return F(),D("div",null,[a(_,{data:e.currentPageData,border:"",stripe:"",style:{width:"100%"}},{default:n(()=>[a(r,{prop:"metadata.name",label:"PVC名称",width:"180"}),a(r,{prop:"metadata.namespace",label:"命名空间",width:"180"}),a(r,{prop:"spec.resources.requests.storage",label:"请求容量",width:"180"}),a(r,{prop:"spec.accessModes",label:"访问模式",width:"300"},{default:n(({row:o})=>[(F(!0),D($,null,A(o.spec.accessModes,b=>(F(),D("div",{key:b,class:"access-mode-tag"},[a(V,null,{default:n(()=>[p(O(b),1)]),_:2},1024)]))),128))]),_:1}),a(r,{label:"操作",width:"200"},{default:n(({row:o})=>[a(d,{type:"primary",onClick:b=>e.handleEdit(o)},{default:n(()=>[p("编辑")]),_:2},1032,["onClick"]),a(d,{type:"danger",onClick:b=>e.handleDelete(o)},{default:n(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(y,{currentPage:e.currentPage,"onUpdate:currentPage":l[0]||(l[0]=o=>e.currentPage=o),"page-size":e.pageSize,total:e.pvcData.length,layout:"total, prev, pager, next, jumper",onCurrentChange:e.handlePageChange},null,8,["currentPage","page-size","total","onCurrentChange"]),a(k,{title:e.dialogTitle,modelValue:e.dialogVisible,"onUpdate:modelValue":l[6]||(l[6]=o=>e.dialogVisible=o)},{footer:n(()=>[a(d,{onClick:l[5]||(l[5]=o=>e.dialogVisible=!1)},{default:n(()=>[p("取消")]),_:1}),a(d,{type:"primary",onClick:e.handleSave},{default:n(()=>[p("保存")]),_:1},8,["onClick"])]),default:n(()=>[a(B,{model:e.currentPVC,"label-width":"120px"},{default:n(()=>[a(c,{label:"PVC名称"},{default:n(()=>[a(g,{modelValue:e.currentPVC.metadata.name,"onUpdate:modelValue":l[1]||(l[1]=o=>e.currentPVC.metadata.name=o)},null,8,["modelValue"])]),_:1}),a(c,{label:"命名空间"},{default:n(()=>[a(g,{modelValue:e.currentPVC.metadata.namespace,"onUpdate:modelValue":l[2]||(l[2]=o=>e.currentPVC.metadata.namespace=o)},null,8,["modelValue"])]),_:1}),a(c,{label:"请求容量"},{default:n(()=>[a(g,{modelValue:e.currentPVC.spec.resources.requests.storage,"onUpdate:modelValue":l[3]||(l[3]=o=>e.currentPVC.spec.resources.requests.storage=o)},null,8,["modelValue"])]),_:1}),a(c,{label:"访问模式"},{default:n(()=>[a(f,{modelValue:e.currentPVC.spec.accessModes,"onUpdate:modelValue":l[4]||(l[4]=o=>e.currentPVC.spec.accessModes=o),multiple:""},{default:n(()=>[a(t,{label:"ReadWriteOnce",value:"ReadWriteOnce"}),a(t,{label:"ReadOnlyMany",value:"ReadOnlyMany"}),a(t,{label:"ReadWriteMany",value:"ReadWriteMany"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),a(d,{type:"success",onClick:e.handleAdd},{default:n(()=>[p("新增PVC")]),_:1},8,["onClick"])])}const N=M(S,[["render",q],["__scopeId","data-v-24cb5e38"]]);export{N as default};
